<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Cardapio Online</title>

</head>
<body>
<header class="barra-topo">
    <a href="index.html" class="botao-voltar"> ‚¨Ö Voltar</a>
</header>
   <main class="detalhe-container">
    <div class="destaque-imagem">
        <img src="heineken.png" alt="Heineken Lat√£o">
    </div>
    <div class="informa√ßao-produtos">
        <h1>Heineken 473ml Lat√£o</h1>
        <p class="informa√ßao-adicionais">Cerveja Puro Malte, super geleda.</p>
        <span class="preco-grande">R$ 12,00</span>
    </div>

    <div class="selecao-quantidade">
        <button class="btn-qtd" onclick="diminuir()">-</button>
        <input type="number" id="quantidade" value="1" >
        <button class="btn-qtd" onclick="aumentar()">+</button>
    </div>
    <button class="botao-pedir" onclick="adicionaraopedido()">Adicionar ao Pedido</button>
   </main>

<div id="modal-identificacao" class="modal-fundo">
        <div class="modal-caixa">
            <h3>Quase l√°! üç∫</h3>
            <p>Me informe seu nome e seu numero com o DDD para eu separar o seu Pedido</p>
            
            <input type="text" id="cliente-nome" placeholder="Seu Nome">
            <input type="tel" id="cliente-telefone" placeholder="Seu Telefone">
            
            <button class="botao-confirmar" onclick="salvarEAdicionar()">Confirmar e Pedir</button>
        </div>
    </div>
    
 <script>
    // --- FUN√á√ïES DOS BOT√ïES + E - ---
    function aumentar() {
        let input = document.getElementById('quantidade');
        input.value = parseInt(input.value) + 1;
    }

    function diminuir() {
        let input = document.getElementById('quantidade');
        if (input.value > 1) {
            input.value = parseInt(input.value) - 1;
        }
    }

         // verifica se o dados do cliente ja esta salvo no navegador que ele acessar
    function adicionaraopedido() {
        console.log("Clicou em Adicionar ao Pedido"); // Para teste
        
        // Verifica se j√° temos o cliente salvo
        let dadosCliente = localStorage.getItem('dadosCliente');
// se nao tem abre a pagina para preencher
        if (!dadosCliente) {
// se os dados ja estao salvo nao aparece a pagina para preencher e ja envia para a pagina de pedido novamente
            console.log("Cliente novo, abrindo modal...");
            document.getElementById('modal-identificacao').style.display = 'flex';
        } else {

            console.log("Cliente j√° conhecido, finalizando...");
            finalizarAdicao();
        }
    }
    // parte de confirma√ßao de dados
    function salvarEAdicionar() {
        console.log("Clicou em Confirmar e Pedir");
// salva no navegador os dados do cliente
        let nomeInput = document.getElementById('cliente-nome');
        let telInput = document.getElementById('cliente-telefone');

        // Se por acaso os IDs estiverem errados no HTML, isso evita travar o site
        if (!nomeInput || !telInput) {
            alert("Erro no c√≥digo: IDs dos inputs n√£o encontrados!");
            return;
        }

        let nome = nomeInput.value;
        let telefone = telInput.value;

        // 2. Valida√ß√£o simples
        if (nome === "" || telefone === "") {
            alert("Por favor, preencha nome e telefone!");
            return;
        }


        let dados = { nome: nome, telefone: telefone };
        localStorage.setItem('dadosCliente', JSON.stringify(dados));
// esconde o formularaio de preencimento
        document.getElementById('modal-identificacao').style.display = 'none';

//Chama a fun√ß√£o final
        finalizarAdicao();
    }

// a fun√ß√£o abaixo vai gravar o item que foi adicionado e assim que finaliza ira mandar para o inicio 
    function finalizarAdicao() {
        try {
            let qtd = parseInt(document.getElementById('quantidade').value);
            
            const produto = {
                id: 'heineken-latao',
                nome: 'Heineken 473ml Lat√£o',
                preco: 12.00,
                imagem: 'heineken.png',
                quantidade: qtd
            };

            // Pega o carrinho antigo ou cria um novo
            let carrinho = JSON.parse(localStorage.getItem('meuCarrinho')) || [];
            
            // Adiciona o produto
            carrinho.push(produto);
            
            // Salva
            localStorage.setItem('meuCarrinho', JSON.stringify(carrinho));
            
            alert('Pedido Adicionado com Sucesso! üç∫');
            window.location.href = "index.html";
            
        } catch (erro) {
            console.error(erro);
            alert("Ocorreu um erro ao salvar: " + erro.message);
        }
    }



   </script>
</body>
</html>

